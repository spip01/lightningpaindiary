<!DOCTYPE html>
<html lang="en">

<head>
    <title>Lightning Pain Diary</title>
    <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
    <meta charset="utf-8">
    <meta id="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <div w3-include-html="file://C:/Users/spip/Documents/GitHub/lightningpaindiary/navbar.html"></div>
    <br>

    <div class="w3-card">
        <header class="w3-container w3-light-gray">
            <h2 style="color: rgb(0, 78, 0);">Pain level</h2>
        </header>
        <br>

        <div id="painlevelpanel" class="w3-container w3-bar w3-round">
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(000, 255, 0); width:10%">1</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(120, 255, 0); width:10%">2</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(180, 255, 0); width:10%">3</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(220, 255, 0); width:10%">4</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 255, 0); width:10%">5</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 225, 0); width:10%">6</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 175, 0); width:10%">7</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 125, 0); width:10%">8</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 070, 0); width:10%">9</button>
            <button type="button" class="w3-btn w3-small w3-bar-item w3-ripple w3-hover-light-gray setPainLevel
               " style="background-color: rgb(255, 000, 0); width:10%">10</button>
        </div>
        <br>

        <div id="detail" class="w3-container w3-small" style="display: none">
            <header class="w3-container w3-light-gray" style="color: rgb(0, 78, 0);">
                Date & Time
            </header>

            <input id="entryDate" class="w3-border w3-round" type="datetime-local">
            <br>
            <br>

            <dev id="medications"></dev>
            <dev id="triggers"></dev>
            <dev id="painlocation"></dev>
            <dev id="paintype"></dev>
            <dev id="warnings"></dev>
            <br>

            <header class="w3-container w3-light-gray" style="color: rgb(0, 78, 0);">
                Relief
            </header>

            <div id="relieflevelpanel" class="w3-container w3-bar w3-round">
                <button type="button" class="w3-btn w3-tiny w3-bar-item w3-ripple w3-hover-light-gray setReliefLevel
               " style="background-color: rgb(0, 255, 0);">5</button>
                <button type="button" class="w3-btn w3-tiny w3-bar-item w3-ripple w3-hover-light-gray setReliefLevel
               " style="background-color: rgb(180, 255, 0);">4</button>
                <button type="button" class="w3-btn w3-tiny w3-bar-item w3-ripple w3-hover-light-gray setReliefLevel
               " style="background-color: rgb(255, 255, 0);">3</button>
                <button type="button" class="w3-btn w3-tiny w3-bar-item w3-ripple w3-hover-light-gray setReliefLevel
               " style="background-color: rgb(255, 175, 0);">2</button>
                <button type="button" class="w3-btn w3-tiny w3-bar-item w3-ripple w3-hover-light-gray setReliefLevel
               " style="background-color: rgb(255, 70, 0);">1</button>
            </div>
            <br>

            <button type="button" class="w3-btn w3-tiny w3-border w3-round w3-ripple" onclick="updateEntry()">Update</button>
            <button type="button" class="w3-btn w3-tiny w3-border w3-round w3-ripple" onclick="newEntry()">New</button>
            <button type="button" class="w3-btn w3-tiny w3-border w3-round w3-ripple">Delete</button>
        </div>
        <br>
    </div>
    <br>

    <p id="diag"></p>

    <script name="setup">
        var createdDate = new Date();
        var changedDate = new Date();
        var entryDate = new Date();
        var painlevel = 0;
        var relieflevel = 0;

        var medicines = "";
        var triggers = "";
        var painlocation = "";
        var paintype = "";
        var warnings = "";

        var medlist = "kepra,rbn6d,g,vevr,brnfev,breb,vewecw,brcwc";
        var triggerlist = "weather,smells";
        var locationlist = "forehead,temple,eyes,left,right,all";
        var typelist = "throbbing,burning,pressure,sharp";
        var warninglist = "aura";

        setup();

        function setup() {
            var i;

            w3.includeHTML();

            var pl = document.getElementsByClassName("setPainLevel");
            for (i = 0; i < pl.length; i++) {
                pl[i].addEventListener("click", painButtons);
            }

            var rl = document.getElementsByClassName("setReliefLevel");
            for (i = 0; i < rl.length; i++) {
                rl[i].addEventListener("click", reliefButtons);
            }

            setupCheckboxeList("Medicines", "medications", medlist);
            setupCheckboxeList("Triggers", "triggers", triggerlist);
            setupCheckboxeList("Pain Location", "painlocation", locationlist);
            setupCheckboxeList("Pain Type", "paintype", typelist);
            setupCheckboxeList("Warnings", "warnings", warninglist);
        }

        function setupCheckboxeList(title, id, list) {
            var panel = document.getElementById(id);
            var row = '<dev class="w3-row">';
            var col =
                '<dev class="w3-col" style="width:20%">' +
                '<input id = "iname" class = "w3-check" style = "width:12px" type = "checkbox">' +
                '<label class = "w3 - small">' +
                'lname' +
                '</label>' +
                '</dev>';
            var html = '<header class="w3-container w3-light-gray" style="color: rgb(0, 78, 0);">' +
                title +
                '</header>' +
                row;

            var items = list.split(",").sort();
            for (i = 0; i < items.length; ++i) {
                html += col.replace("iname", items[i]).replace("lname", items[i]);

                if ((i + 1) % 5 == 0)
                    html += '</dev>' + row;
            }

            html += '</dev></dev>';
            panel.innerHTML += html;
        }

        function procCheckboxList(list) {
            var rstr = "";
            var items = list.split(",").sort();

            for (i = 0; i < items.length; ++i) {
                chk = document.getElementById(items[i]);
                if (chk.checked)
                    rstr += items[i] + ",";
            }

            rstr = rstr.slice(0, rstr.length - 1);

            return rstr;
        }

        function painButtons() {
            painlevel = Number(this.innerHTML);

            var panel = document.getElementById("detail");
            if (panel.style.display === "none") {
                panel.style.display = "block";

                var edate = document.getElementById("entryDate");
                edate.value = createdDate.toDateTimeLocalString();

                newEntry()
            }

            var i;
            var pl = document.getElementsByClassName("setPainLevel");

            for (i = 0; i < pl.length; i++) {
                pl[i].className = pl[i].className.replace(" w3-aqua", "");
            }

            this.className += " w3-aqua";

            diag();
        }

        function reliefButtons() {
            relieflevel = Number(this.innerHTML);

            var i;
            var rl = document.getElementsByClassName("setReliefLevel");

            for (i = 0; i < rl.length; i++) {
                rl[i].className = rl[i].className.replace(" w3-aqua", "");
            }

            this.className += " w3-aqua";
        }
    </script>

    <script>
        function newEntry() {
            createdDate = new Date();
            changedDate = new Date();

            //** keep current entry date so it doesn't have to be completely reentered every time **
            //var edate = document.getElementById("entryDate");
            //edate.value = createdDate.toDateTimeLocalString();

            diag();
        }

        function updateEntry() {
            changedDate = new Date();

            var edate = document.getElementById("entryDate");
            entryDate = new Date(edate.value);

            medicines = procCheckboxList(medlist);
            triggers = procCheckboxList(triggerlist);
            painlocation = procCheckboxList(locationlist);
            paintype = procCheckboxList(typelist);
            warnings = procCheckboxList(warninglist);

            diag();
        }

        function diag() {
            var diag = document.getElementById("diag");
            diag.innerHTML =
                "<br>created: " + createdDate.toISOString() +
                "<br>updated: " + changedDate.toISOString() +
                "<br>entry: " + entryDate.toISOString() +
                "<br>pain: " + painlevel +
                "<br>meds: " + medicines +
                "<br>triggers: " + triggers +
                "<br>location: " + painlocation +
                "<br>type: " + paintype +
                "<br>warnings: " + warnings +
                "<br>relief: " + relieflevel;
        }

        Date.prototype.toDateTimeLocalString =
            function toDateTimeLocalString() {
                var date = this;
                var ten = function (i) {
                    return i < 10 ? '0' + i : i;
                }
                return date.getFullYear() +
                    "-" + ten(date.getMonth() + 1) +
                    "-" + ten(date.getDate()) +
                    "T" + ten(date.getHours()) +
                    ":" + ten(date.getMinutes());
            }
    </script>

    <div>
        <br>
        <br>log - name
        <br>&nbsp;&nbsp; pain
        <br>&nbsp;&nbsp;&nbsp;&nbsp; date
        <br>&nbsp;&nbsp;&nbsp;&nbsp; time
        <br>&nbsp;&nbsp;&nbsp;&nbsp; level
        <br>&nbsp;&nbsp;&nbsp;&nbsp; medications (ck boxes +add)
        <br>&nbsp;&nbsp;&nbsp;&nbsp; relief
        <br>
        <br>&nbsp;&nbsp;&nbsp;&nbsp; type (burning, throbbing... ck boxes)
        <br>
        <br>&nbsp;&nbsp;&nbsp;&nbsp; headache
        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location (ck boxes)
        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; triggers (ck boxes)
        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; warnings (ck boxes)
        <br>
        <br>&nbsp;&nbsp; bp
        <br>&nbsp;&nbsp; weight
        <br>&nbsp;&nbsp; notes
        <br>
        <br>&nbsp;&nbsp; --new
        <br>&nbsp;&nbsp; --edit
        <br>&nbsp;&nbsp; --delete
        <br>
        <br>
        <br>calendar
        <br>
        <br>
        <br>reports
        <br>&nbsp;&nbsp; format
        <br>&nbsp;&nbsp;&nbsp;&nbsp; fields (ck boxes)
        <br>&nbsp;&nbsp; qr code - short url
        <br>&nbsp;&nbsp; email
        <br>&nbsp;&nbsp; print
        <br>
        <br>
        <br>medlist
        <br>&nbsp;&nbsp; preventative
        <br>&nbsp;&nbsp; abortive
        <br>&nbsp;&nbsp; drugs.com profile link
        <br>
        <br>
        <br>doctors
        <br>
        <br>
        <br>settings
        <br>&nbsp;&nbsp; remind to complete
        <br>
        <br>
        <br>contact about copyright
    </div>

    <div w3-include-html="file://C:/Users/spip/Documents/GitHub/lightningpaindiary/footer.html"></div>
</body>

</html>